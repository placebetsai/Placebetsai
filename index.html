<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PlaceBets.ai</title>
  <link rel="stylesheet" href="Assets/style.css" />
</head>
<body>
  <header>
    <h1>PlaceBets.ai</h1>
    <p>Search odds, teams, matches, or get roasted.</p>
    <input type="text" id="searchBox" placeholder="Search teams, odds, matches..."/>
  </header>

  <div class="card-grid" id="eventList"></div>
  <button id="loadMore">Show More</button>

  <!-- Botpress Embed -->
  <script src="https://cdn.botpress.cloud/webchat/v3/inject.js"></script>
  <script>
    window.botpressWebChat.init({
      configUrl: "https://files.bpcontent.cloud/2025/07/03/19/20250703190713-ODG9KBZT.json",
      botId: "539d8fd6-0467-49c5-ba74-367f2e8ec6cb",
      hostUrl: "https://cdn.botpress.cloud/webchat/v3",
      disableAnimations: false,
    });
  </script>

  <!-- Event Rendering Script -->
  <script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ31pX6TDzfhTY3SH6D6kWBR1YOEA4azrACIF9b8Y_w14a5U0-eDTHgJ8F1TFB3Y9uZm__Sl2JeQZRE/pub?output=csv';
    const searchBox = document.getElementById('searchBox');
    const eventList = document.getElementById('eventList');
    const loadMoreBtn = document.getElementById('loadMore');
    let allEvents = [];
    let currentIndex = 0;
    const eventsPerLoad = 3;

    fetch(sheetURL)
      .then(response => response.text())
      .then(csv => {
        const lines = csv.split('\n').slice(1);
        allEvents = lines.map(line => {
          const [match, date, time, team1, team2, odds1, odds2, trash] = line.split(',');
          return {
            match, date, time, team1, team2, odds1, odds2, trash
          };
        }).filter(e => e.match);
        renderEvents();
      });

    function renderEvents() {
      const end = Math.min(currentIndex + eventsPerLoad, allEvents.length);
      for (let i = currentIndex; i < end; i++) {
        const e = allEvents[i];
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <div class="card-header">
            <img src="https://placehold.co/40x40" alt="Logo" />
            <span>${e.team1} vs ${e.team2}</span>
            <img src="https://placehold.co/40x40" alt="Logo" />
          </div>
          <div><strong>Match:</strong> ${e.match}</div>
          <div><strong>Date:</strong> ${e.date} ${e.time}</div>
          <div><strong>Odds:</strong> ${e.odds1} - ${e.odds2}</div>
          <div class="trashtalk">${e.trash}</div>
        `;
        eventList.appendChild(div);
      }
      currentIndex = end;
      if (currentIndex >= allEvents.length) {
        loadMoreBtn.style.display = 'none';
      }
    }

    loadMoreBtn.addEventListener('click', renderEvents);

    searchBox.addEventListener('input', () => {
      const q = searchBox.value.toLowerCase();
      eventList.innerHTML = '';
      currentIndex = 0;
      const filtered = allEvents.filter(e =>
        `${e.match} ${e.team1} ${e.team2} ${e.trash} ${e.odds1} ${e.odds2}`.toLowerCase().includes(q)
      );
      allEvents = filtered;
      renderEvents();
    });
  </script>
</body>
</html>
